# GEKKO 変更ログ: 建物追加・デバッグモード・敵サイズ・ER層コリジョン

## 1. 茶色の島（ER層）にコリジョン追加

### 問題
前回のセッションで草（GR）層は `P()` に変更済みだったが、
その下の茶色の土（ER）層はまだ `D()` のまま。
ER 層は GR 層より幅が広いため、端の茶色い部分が見えているのに乗れない状態だった。

### 例: Island 1A
```
ER(-7,17, 0,   16x14)  ← 幅16、奥行14（広い）
GR(-7,17, 0.5, 12x10)  ← 幅12、奥行10（狭い）
```
ER の端 2 ユニット分が GR に覆われず露出 → 見えるのに乗れない。

### 修正
12箇所の ER `D()` → `P()` に変更（前回の GR と同じアプローチ）。

## 2. 障害物となる建物の追加

### 設計方針
- **クラシックな直方体ビル**: 壁色 `WL=[55,62,82]` + 屋根色 `RF=[72,48,42]`（レンガ調）
- 屋根は壁より少し大きい（オーバーハング）
- 窓はネオン装飾（`D()` で薄い発光面）

### 配置場所

| 島 | 建物内容 |
|---|---|
| Central Dock | 小屋x2 + 低壁x1 + 塔x2（左右対称）+ 窓ネオン |
| Market 1A-1E | 各島にショップブロック + 低壁カバー |
| Boss Arena | 4本のカバー柱（十字配置、近接戦闘の遮蔽用） |

### コード例（Central Dock の小屋）
```js
var WL=[55,62,82], WLs=[38,45,60];  // 壁色
var RF=[72,48,42], RFs=[55,35,30];  // 屋根色

P(-4,4,0, 2.5,2.5,1.8, WL,WLs);     // 壁（高さ1.8）
P(-4,4,1.8, 2.8,2.8,0.15, RF,RFs);   // 屋根（少し大きい）
D(-4,4,1.4, 0.6,0.05,0.35, NC,NC);   // 窓ネオン（装飾）
```

**ポイント**: 屋根の `w,d` を壁より `+0.3` 大きくすることで
張り出し（eaves/軒）が表現される。`h` は `0.15` と薄い。

## 3. 敵サイズの拡大

| 敵 | 旧 sz | 新 sz | 変更率 |
|---|---|---|---|
| Wyvern | 0.8 | 1.2 | +50% |
| Harpy | 0.7 | 1.0 | +43% |
| Golem | 1.2 | 1.8 | +50% |
| Serpent | 0.6 | 0.9 | +50% |
| Dragon | 1.8 | 2.5 | +39% |

`sz` はビルボードスプライトの高さ（ワールド単位）。
当たり判定半径 `def.sz * def.sz * 0.3` にも影響するため、
大きくなると弾が当たりやすくなる → 若干イージーになる副効果。

## 4. デバッグモード

### 操作
**F3 キー** でトグル ON/OFF

### 表示内容（左上のパネル）
```
FPS: 30              ← 28未満で黄色警告
X:0.0 Y:0.0          ← プレイヤー座標
Z:0.50                ← 高度
SPD:4.5 VZ:0.0       ← 水平速度・垂直速度
FLOOR:GND GND        ← フロアレベル・接地状態（緑=GND/赤=AIR）
MOM:1.00 JET:1.2     ← モメンタム倍率・ジェット燃料
DASH:0.0 iFRM:0.0    ← ダッシュCD・無敵フレーム残
HP:100/100            ← 体力（色が変化: 緑→黄→赤）
ENEMIES:5 WAVE:1/5   ← 残敵数・ウェーブ
PLAT:87 DECO:42      ← コリジョン/装飾オブジェクト数
NEAR PLAT:            ← 最寄りプラットフォーム情報
 pos:(0,0,-0.5)       ← 位置
 sz:18.0x18.0 h:0.5 top:0.0  ← サイズ・天面高度
```

### 実装構造
```js
var debugMode = false;
var debugFps = 0, debugFrames = 0, debugFpsTimer = 0;

// FPS 計測: 0.5 秒ごとにフレーム数からFPSを算出
debugFrames++;
if (nowSec - debugFpsTimer >= 0.5) {
  debugFps = Math.round(debugFrames / (nowSec - debugFpsTimer));
  debugFrames = 0;
  debugFpsTimer = nowSec;
}
```

### 使い方
1. ゲーム中に F3 を押す
2. 左上にデバッグパネルが表示される
3. 「島に乗れない」等の問題が起きたら `Z` 値と `NEAR PLAT` の `top` 値を比較
   - プレイヤーの Z がプラットフォームの top より低いのに GND にならない
     → そのプラットフォームが `decor` 配列に入っている可能性
4. `PLAT` と `DECO` の数でコリジョン対象の数を確認
5. 敵の問題は `ENEMIES` カウントで残敵を確認

## 今回の変更ファイル
- `js/fps.js` のみ（2051行 → 2158行）
